var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,n=(e,a)=>{for(var l in a||(a={}))o.call(a,l)&&s(e,l,a[l]);if(t)for(var l of t(a))i.call(a,l)&&s(e,l,a[l]);return e},m=(e,t)=>a(e,l(t));import{a as d,_ as r}from"./notflag-0304cc57.js";import{u as c}from"./editSpace-11688fce.js";import{u,t as p}from"./teamSelector-ea6a18b4.js";import{u as g}from"./usePlayers-fc66d8cb.js";import{_ as f}from"./plugin-vue_export-helper-46f75680.js";import{d as b,r as v,k as y,t as D,a as h,o as V,c as S,w as T,b as k,f as x,j as C,h as $,e as O,F as L,i as w,p as _,g as N}from"./index-a94469d0.js";import{s as U,b as j}from"./util-2caaee94.js";var P=f(b({name:"leagueSelector",components:{},props:{modelValue:{type:String,default:""},filterable:{type:Boolean,default:!0},remote:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,a){const l=c();let t=v({selectOptions:[],valueName:"",selectLoading:!1,cloneSelectOptions:[]}),o={handleSelectVisible(e){e||(t.selectOptions=t.cloneSelectOptions)},remoteMethod(e){if(""!==e){let l;t.selectLoading=!0,l&&clearTimeout(l),l=setTimeout((()=>{if(t.selectLoading=!1,!isNaN(parseFloat(e))&&isFinite(e))return void(t.selectOptions=t.cloneSelectOptions.filter((a=>a.value==e)));let a=new RegExp(e,"i");t.selectOptions=t.cloneSelectOptions.filter((e=>a.test(e.label)))}),500),a.emit("update:modelValue",t.valueName)}else t.selectOptions=t.cloneSelectOptions},handleChange(e){a.emit("update:modelValue",e),a.emit("change",e)}};return y((()=>{t.selectOptions=l.getAllLeagueList(),t.cloneSelectOptions=JSON.parse(JSON.stringify(t.selectOptions)),t.valueName=e.modelValue})),m(n(n({},D(t)),o),{editSpaceStore:l})}}),[["render",function(e,a,l,t,o,i){const s=h("el-select-v2");return V(),S(s,{modelValue:e.valueName,"onUpdate:modelValue":a[0]||(a[0]=a=>e.valueName=a),filterable:e.filterable,options:e.selectOptions,onVisibleChange:e.handleSelectVisible,onChange:e.handleChange,remote:e.remote,multiple:e.multiple,clearable:e.clearable,disabled:e.disabled,"remote-method":e.remoteMethod,placeholder:e.$t("message.selectLeaguePlaceholder"),loading:e.selectLoading},null,8,["modelValue","filterable","options","onVisibleChange","onChange","remote","multiple","clearable","disabled","remote-method","placeholder","loading"])}]]);const B=b({name:"StadiumSelectDialog",components:{},props:{visible:{type:Boolean,default:!1},stadium:{type:String,default:"-1"}},emits:["close","save"],setup(e,a){const l=c();let t=v({dialogVisible:e.visible,stadiumList:l.getAllStadiumList(),currentStadium:{}}),o={handleClose(){o.getCurrentStadium(),t.dialogVisible=!1,a.emit("close")},handleConfirm(){a.emit("save",t.currentStadium.value),t.dialogVisible=!1,a.emit("close")},getCurrentStadium(){let a=t.stadiumList.find((a=>a.value==e.stadium));t.currentStadium=a||{value:"-1",label:"No Stadium"}},handleChange(e){let a=t.stadiumList.findIndex((e=>e.value==t.currentStadium.value));if(e>0){let e=a+1;e>t.stadiumList.length-1&&(e=0),t.currentStadium=t.stadiumList[e]}else{let e=a-1;e<0&&(e=t.stadiumList.length-1),t.currentStadium=t.stadiumList[e]}}};return y((()=>{o.getCurrentStadium()})),n(n(n({},D(t)),o),u())}}),F={class:"flex-column-center"},A={class:"stadium-selector-box"},E={class:"flex-center"},I={class:"stadium-img-box"},q={class:"flex-center"},z={style:{"margin-top":"20px"}},J={class:"dialog-footer"};const M=b({name:"TeamEdit",components:{teamSelector:p,leagueSelector:P,StadiumSelectDialog:f(B,[["render",function(e,a,l,t,o,i){const s=h("CaretLeft"),n=h("el-icon"),m=h("el-image"),d=h("CaretRight"),r=h("el-button"),c=h("el-dialog");return V(),S(c,{modelValue:e.dialogVisible,"onUpdate:modelValue":a[2]||(a[2]=a=>e.dialogVisible=a),title:e.$t("message.stadiumselect"),"before-close":e.handleClose,"custom-class":"z-dialog",center:"",width:500},{footer:T((()=>[k("span",J,[x(r,{onClick:e.handleClose},{default:T((()=>[C($(e.$t("message.cancel")),1)])),_:1},8,["onClick"]),x(r,{type:"primary",onClick:e.handleConfirm},{default:T((()=>[C($(e.$t("message.confirm")),1)])),_:1},8,["onClick"])])])),default:T((()=>[k("div",F,[k("div",A,[k("div",E,[x(n,{onClick:a[0]||(a[0]=a=>e.handleChange(-1))},{default:T((()=>[x(s)])),_:1})]),k("div",I,[x(m,{style:{height:"100%",width:"100%"},lazy:"",src:e.getStadiumBackground(e.currentStadium.value),fit:"cover"},null,8,["src"])]),k("div",q,[x(n,{onClick:a[1]||(a[1]=a=>e.handleChange(1))},{default:T((()=>[x(d)])),_:1})])]),k("p",z,$(e.currentStadium.label),1)])])),_:1},8,["modelValue","title","before-close"])}],["__scopeId","data-v-1b838803"]])},props:{},setup(e,a){const l=c(),{proxy:s}=N(),d=u(),r=g();let p=v({teamData:null,cloneTeamData:null,isNotFound:!1,teamPlayerLineup:null,marks:{10:"保守",50:"平衡",90:"激进"},stadiumVisible:!1,saveloading:!1}),f={handleColor(e,a){let l=U(e);p.cloneTeamData[`${a}r`]=l[0],p.cloneTeamData[`${a}g`]=l[0],p.cloneTeamData[`${a}b`]=l[0]},getTeamData(){var e,a;const t=s.$route.query.teamid;if(p.teamData=l.data.teams&&l.data.teams.find((e=>e.teamid==t)),!p.teamData)return p.isNotFound=!0,void s.$message.warning(`${s.$t("message.notfoundteam")}`);p.cloneTeamData={},Object.keys(p.teamData).forEach((e=>{!isNaN(parseFloat(p.teamData[e]))&&isFinite(p.teamData[e])?"rivalteam"===e||e.endsWith("id")?p.cloneTeamData[e]=p.teamData[e]:p.cloneTeamData[e]=parseInt(p.teamData[e]):p.cloneTeamData[e]=p.teamData[e]})),p.cloneTeamData.leagueid=(null==(e=l.data.leagueteamlinks.find((e=>e.teamid==t)))?void 0:e.leagueid)||"-1",p.cloneTeamData.stadiumid=(null==(a=l.data.teamstadiumlinks.find((e=>e.teamid==t)))?void 0:a.stadiumid)||"-1",p.cloneTeamData.teamcolor1=j([p.teamData.teamcolor1r,p.teamData.teamcolor1g,p.teamData.teamcolor1b]),p.cloneTeamData.teamcolor2=j([p.teamData.teamcolor2r,p.teamData.teamcolor2g,p.teamData.teamcolor2b]),p.cloneTeamData.teamcolor3=j([p.teamData.teamcolor3r,p.teamData.teamcolor3g,p.teamData.teamcolor3b])},getTeamPlayerLineup(){const e=s.$route.query.teamid;if(!l.data.teamplayerlinks)return;let a=l.data.teamplayerlinks.map((a=>{let t=null;a.teamid==e&&(t=l.data.players.find((e=>e.playerid==a.playerid)));let o=t?r.getPlayerName.value(t.firstnameid,t.lastnameid,t.commonnameid):"";return t?{label:o,value:a.playerid,playerdata:t}:null}));p.teamPlayerLineup=a.filter(Boolean)},handleSave(){p.saveloading=!0;const e=JSON.parse(JSON.stringify(p.cloneTeamData)),{leagueid:a,stadiumid:s,teamcolor1:n,teamcolor2:m,teamcolor3:d}=e,r=((e,a)=>{var l={};for(var s in e)o.call(e,s)&&a.indexOf(s)<0&&(l[s]=e[s]);if(null!=e&&t)for(var s of t(e))a.indexOf(s)<0&&i.call(e,s)&&(l[s]=e[s]);return l})(e,["leagueid","stadiumid","teamcolor1","teamcolor2","teamcolor3"]);l.saveTeamData(r,{leagueid:a,stadiumid:s}),p.saveloading=!1}};return y((()=>{f.getTeamPlayerLineup(),f.getTeamData()})),n(n(m(n(n({},D(p)),f),{editSpaceStore:l}),d),r)}}),R={class:"full-layout flex-column-center scrollbar routerview",style:{"overflow-y":"auto"}},W={class:"flex-between full-w edit-header"},G={class:"flex-end",style:{"margin-left":"10px"}},H={class:"player-box full-layout"},K={class:"flex-between flex-warp"},Q={class:"flex-start",style:{"align-items":"flex-end"}},X={class:"player-avatar"},Y={class:"image-slot"},Z=["src"],ee={class:"image-slot"},ae=["src"],le={class:"flex-column-end player-info"},te={class:"player-name text-left"},oe={class:"flex-start"},ie=["src"],se={class:"player-formation"},ne={class:"flex-between player-team"},me={class:"img-box",style:{height:"80px"}},de=["src","title"],re=["src","title"],ce={class:"tab-1"},ue={style:{margin:"20px 0"}},pe={class:"tab-1"},ge={style:{margin:"20px 0"}};var fe=f(M,[["render",function(e,a,l,t,o,i){const s=h("ArrowLeftBold"),n=h("el-icon"),m=h("el-button"),c=h("el-skeleton"),u=h("el-empty"),p=h("el-image"),g=h("el-avatar"),f=h("el-input"),b=h("el-input-number"),v=h("el-color-picker"),y=h("teamSelector"),D=h("leagueSelector"),N=h("el-option"),U=h("el-select"),j=h("el-form-item"),P=h("el-form"),B=h("el-slider"),F=h("StadiumSelectDialog");return V(),O("div",R,[e.editSpaceStore.isUpload?(V(),O(L,{key:0},[k("div",W,[x(n,{class:"back-icon",onClick:a[0]||(a[0]=a=>e.$router.go(-1))},{default:T((()=>[x(s)])),_:1}),k("div",G,[x(m,{type:"success",onClick:e.handleSave,loading:e.saveloading},{default:T((()=>[C($(e.$t("message.save")),1)])),_:1},8,["onClick","loading"])])]),k("div",H,[e.teamData||e.isNotFound?!e.teamData&&e.isNotFound?(V(),S(u,{key:1,description:e.$t("message.notfoundteam")},null,8,["description"])):(V(),O(L,{key:2},[k("div",K,[k("div",Q,[k("div",X,[x(p,{style:{height:"100%",width:"100%"},lazy:"",src:e.getTeamAvatar(e.teamData.teamid,120),fit:"cover"},{placeholder:T((()=>[k("div",Y,[k("img",{src:d,style:{"object-fit":"cover"}},null,8,Z)])])),error:T((()=>[k("div",ee,[k("img",{src:d,style:{"object-fit":"cover"}},null,8,ae)])])),_:1},8,["src"])]),k("div",le,[k("p",te,$(e.teamData.teamname+`  (${e.teamData.teamid})`),1),k("div",oe,[x(g,{shape:"square",size:24,style:{width:"24px",height:"16px"},fit:"cover",src:e.getTeamNationFlag(e.teamData.teamid),onError:e=>!0},{default:T((()=>[k("img",{src:r},null,8,ie)])),_:1},8,["src"]),k("span",se,$(e.getTeamLeagueName(e.teamData.teamid)),1)])])]),k("div",ne,[k("div",me,[k("img",{src:"/static/png/lineup-4c5aa955.png",onClick:a[1]||(a[1]=a=>e.$router.push({name:"teamLineupEdit",query:{teamid:e.cloneTeamData.teamid}})),style:{transform:"rotate(90deg)"},title:e.$t("message.lineupManagement")},null,8,de)]),k("div",{class:"img-box",onClick:a[2]||(a[2]=a=>e.stadiumVisible=!0)},[k("img",{src:"/static/png/stadium-a3169e20.png",title:e.$t("message.stadiumManagement")},null,8,re)])])]),e.cloneTeamData&&e.cloneTeamData.teamid?(V(),O(L,{key:0},[k("div",ce,$(e.$t("message.baseData")),1),k("div",ue,[x(P,{inline:!0,model:e.cloneTeamData,class:"flex-start flex-warp"},{default:T((()=>[(V(!0),O(L,null,_(e.$config.teamBaseData,(a=>(V(),S(j,{key:a.label,label:e.$t(`message.${a.label}`)},{default:T((()=>["input"===a.type?(V(),S(f,{key:0,modelValue:e.cloneTeamData[a.label],"onUpdate:modelValue":l=>e.cloneTeamData[a.label]=l},null,8,["modelValue","onUpdate:modelValue"])):"number"===a.type?(V(),S(b,{key:1,modelValue:e.cloneTeamData[a.label],"onUpdate:modelValue":l=>e.cloneTeamData[a.label]=l,min:a.min,max:a.max},null,8,["modelValue","onUpdate:modelValue","min","max"])):"color"===a.type?(V(),S(v,{key:2,modelValue:e.cloneTeamData[a.label],"onUpdate:modelValue":l=>e.cloneTeamData[a.label]=l,onActiveChange:l=>e.handleColor(l,a.label)},null,8,["modelValue","onUpdate:modelValue","onActiveChange"])):"teamselect"===a.type?(V(),S(y,{key:3,modelValue:e.cloneTeamData[a.label],"onUpdate:modelValue":l=>e.cloneTeamData[a.label]=l},null,8,["modelValue","onUpdate:modelValue"])):"leagueselect"===a.type?(V(),S(D,{key:4,modelValue:e.cloneTeamData[a.value],"onUpdate:modelValue":l=>e.cloneTeamData[a.value]=l},null,8,["modelValue","onUpdate:modelValue"])):"playerselect"===a.type?(V(),S(U,{key:5,modelValue:e.cloneTeamData[a.value],"onUpdate:modelValue":l=>e.cloneTeamData[a.value]=l,multiple:a.multiple,placeholder:e.$t("message.selectPlaceholder")},{default:T((()=>[(V(!0),O(L,null,_(e.teamPlayerLineup,(e=>(V(),S(N,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","multiple","placeholder"])):w("",!0)])),_:2},1032,["label"])))),128))])),_:1},8,["model"])]),k("div",pe,$(e.$t("message.tactic")),1),k("div",ge,[x(P,{inline:!0,model:e.cloneTeamData,class:"flex-start flex-warp"},{default:T((()=>[(V(!0),O(L,null,_(e.$config.teamTactic,(a=>(V(),S(j,{key:a.label,label:e.$t(`message.${a.label}`),style:{"margin-bottom":"30px"}},{default:T((()=>["slide"===a.type?(V(),S(B,{key:0,modelValue:e.cloneTeamData[a.label],"onUpdate:modelValue":l=>e.cloneTeamData[a.label]=l,min:1,max:100,step:1,marks:e.marks},null,8,["modelValue","onUpdate:modelValue","marks"])):"select"===a.type?(V(),S(U,{key:1,modelValue:e.cloneTeamData[a.label],"onUpdate:modelValue":l=>e.cloneTeamData[a.label]=l,placeholder:e.$t("message.selectPlaceholder")},{default:T((()=>[(V(!0),O(L,null,_(a.data,(a=>(V(),S(N,{key:a.value,label:e.$t(`message.${a.label}`),value:a.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])):w("",!0)])),_:2},1032,["label"])))),128))])),_:1},8,["model"])])],64)):w("",!0)],64)):(V(),S(c,{key:0,rows:20,animated:""}))])],64)):(V(),S(u,{key:1,description:e.$t("message.errorInfo")},null,8,["description"])),e.stadiumVisible?(V(),S(F,{key:2,visible:e.stadiumVisible,stadium:e.cloneTeamData.stadiumid,onSave:a[3]||(a[3]=a=>e.cloneTeamData.stadiumid=a),onClose:a[4]||(a[4]=a=>e.stadiumVisible=!1)},null,8,["visible","stadium"])):w("",!0)])}],["__scopeId","data-v-a4201af8"]]);export{fe as default};
